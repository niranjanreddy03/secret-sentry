# ğŸ—ï¸ Vault Sentry - System Architecture

> A comprehensive technical architecture document for the Vault Sentry cloud-native secret detection platform.

---

## ğŸ“‹ Table of Contents

1. [Executive Summary](#executive-summary)
2. [System Overview](#system-overview)
3. [Architecture Diagram](#architecture-diagram)
4. [Component Details](#component-details)
5. [Data Flow](#data-flow)
6. [Database Schema](#database-schema)
7. [Security Architecture](#security-architecture)
8. [Scalability Considerations](#scalability-considerations)
9. [Technology Stack](#technology-stack)

---

## Executive Summary

**Vault Sentry** is an enterprise-grade DevSecOps platform designed to automatically detect exposed secrets (API keys, credentials, tokens, and sensitive configurations) across code repositories, cloud storage, and CI/CD pipelines.

### Key Capabilities

| Capability | Description |
|------------|-------------|
| **Secret Detection** | 100+ regex patterns + Shannon entropy analysis |
| **Multi-Platform** | GitHub, GitLab, Bitbucket, AWS S3 integration |
| **Real-Time Scanning** | Webhook-triggered scans on code push |
| **Risk Scoring** | Critical â†’ High â†’ Medium â†’ Low severity classification |
| **Compliance Reporting** | PDF/JSON/SARIF report generation |
| **CI/CD Integration** | GitHub Actions, GitLab CI pipeline blocking |
| **Role-Based Access** | Admin, Developer, Viewer permissions |

---

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Vault Sentry PLATFORM                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                    â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚                              â”‚    ENTRY POINTS     â”‚                               â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚    â”‚   Web Dashboard  â”‚    â”‚   CLI Client     â”‚    â”‚   CI/CD Webhooks â”‚           â”‚
â”‚    â”‚   (Next.js 14)   â”‚    â”‚   (Python)       â”‚    â”‚   (GitHub/GitLab)â”‚           â”‚
â”‚    â”‚                  â”‚    â”‚                  â”‚    â”‚                  â”‚           â”‚
â”‚    â”‚   â€¢ Dark Theme   â”‚    â”‚   â€¢ Local Scan   â”‚    â”‚   â€¢ Push Events  â”‚           â”‚
â”‚    â”‚   â€¢ Charts       â”‚    â”‚   â€¢ CI Pipeline  â”‚    â”‚   â€¢ PR Checks    â”‚           â”‚
â”‚    â”‚   â€¢ Real-time    â”‚    â”‚   â€¢ SARIF Export â”‚    â”‚   â€¢ Auto-block   â”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚             â”‚                       â”‚                        â”‚                     â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                     â”‚                                              â”‚
â”‚                                     â–¼                                              â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                         â”‚   NGINX Reverse Proxy â”‚                                  â”‚
â”‚                         â”‚   â€¢ SSL Termination   â”‚                                  â”‚
â”‚                         â”‚   â€¢ Load Balancing    â”‚                                  â”‚
â”‚                         â”‚   â€¢ Rate Limiting     â”‚                                  â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                     â”‚                                              â”‚
â”‚                                     â–¼                                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                        â”‚    FastAPI Backend     â”‚                                  â”‚
â”‚                        â”‚    (REST API Server)   â”‚                                  â”‚
â”‚                        â”‚                        â”‚                                  â”‚
â”‚                        â”‚  â€¢ JWT Authentication  â”‚                                  â”‚
â”‚                        â”‚  â€¢ RBAC Authorization  â”‚                                  â”‚
â”‚                        â”‚  â€¢ Input Validation    â”‚                                  â”‚
â”‚                        â”‚  â€¢ OpenAPI/Swagger     â”‚                                  â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                    â”‚                                               â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚                        â”‚                        â”‚                      â”‚
â”‚           â–¼                        â–¼                        â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   PostgreSQL    â”‚     â”‚     Redis       â”‚     â”‚   Celery Workers     â”‚         â”‚
â”‚  â”‚   Database      â”‚     â”‚   Cache/Queue   â”‚     â”‚                      â”‚         â”‚
â”‚  â”‚                 â”‚     â”‚                 â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚
â”‚  â”‚  â€¢ Users        â”‚     â”‚ â€¢ JWT Sessions  â”‚     â”‚  â”‚ Scanner Engine â”‚  â”‚         â”‚
â”‚  â”‚  â€¢ Repositories â”‚     â”‚ â€¢ Rate Limits   â”‚     â”‚  â”‚                â”‚  â”‚         â”‚
â”‚  â”‚  â€¢ Scans        â”‚     â”‚ â€¢ Job Queue     â”‚     â”‚  â”‚ â€¢ Regex Match  â”‚  â”‚         â”‚
â”‚  â”‚  â€¢ Secrets      â”‚     â”‚ â€¢ Pub/Sub       â”‚     â”‚  â”‚ â€¢ Entropy Calc â”‚  â”‚         â”‚
â”‚  â”‚  â€¢ Alerts       â”‚     â”‚                 â”‚     â”‚  â”‚ â€¢ Keyword Scan â”‚  â”‚         â”‚
â”‚  â”‚  â€¢ API Keys     â”‚     â”‚                 â”‚     â”‚  â”‚ â€¢ S3 Scanner   â”‚  â”‚         â”‚
â”‚  â”‚  â€¢ Integrations â”‚     â”‚                 â”‚     â”‚  â”‚ â€¢ Env Analyzer â”‚  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚
â”‚                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                              â”‚                     â”‚
â”‚                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                              â”‚                           â”‚         â”‚
â”‚                                              â–¼                           â–¼         â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                                    â”‚ Alert System  â”‚           â”‚ PDF Reporter  â”‚  â”‚
â”‚                                    â”‚               â”‚           â”‚               â”‚  â”‚
â”‚                                    â”‚ â€¢ Email/SMTP  â”‚           â”‚ â€¢ ReportLab   â”‚  â”‚
â”‚                                    â”‚ â€¢ Slack       â”‚           â”‚ â€¢ Charts      â”‚  â”‚
â”‚                                    â”‚ â€¢ Webhooks    â”‚           â”‚ â€¢ Compliance  â”‚  â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Diagram

### Request Flow: User â†’ Dashboard â†’ API â†’ Scanner â†’ Database â†’ Alert

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER   â”‚      â”‚ DASHBOARD  â”‚      â”‚   API    â”‚      â”‚ SCANNER  â”‚      â”‚ DATABASE â”‚      â”‚  ALERT   â”‚
â”‚          â”‚      â”‚ (Frontend) â”‚      â”‚(Backend) â”‚      â”‚ (Worker) â”‚      â”‚(Postgres)â”‚      â”‚ SYSTEM   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚  1. Open App     â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚  2. Login        â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚ 3. POST /login   â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚ 4. Validate User â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
     â”‚                  â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
     â”‚                  â”‚â—€â”€JWT Tokenâ”€â”€â”€â”€â”€â”‚                  â”‚                 â”‚                  â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚  5. Add Repository                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚ 6. POST /repos   â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚ 7. Store Repo    â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
     â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                 â”‚                  â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚  8. Trigger Scan â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚ 9. POST /scans   â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚ 10. Queue Job    â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â–¶â”‚                 â”‚                  â”‚
     â”‚                  â”‚â—€â”€Scan IDâ”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                 â”‚                  â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚ 11. Clone Repo  â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”          â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚      â”‚          â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”˜          â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚ 12. Scan Files  â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚ â€¢ Regex Match   â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚ â€¢ Entropy Calc  â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚ â€¢ Risk Score    â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”          â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚      â”‚          â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”˜          â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚ 13. Store Secrets                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚ 14. Create Alert â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚ (if critical)    â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚ 15. Send
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚ Notifications
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚â”€â”€â”€â”€â”
     â”‚â—€â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
     â”‚                  â”‚    (Email/Slack Notification)       â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚ 16. View Results â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚ 17. GET /scans/idâ”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚ 18. Fetch Resultsâ”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
     â”‚                  â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
     â”‚                  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                 â”‚                  â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                  â”‚                  â”‚                 â”‚                  â”‚
```

---

## Component Details

### 1. Frontend (Next.js 14 Dashboard)

**Location:** `frontend/`

| Feature | Implementation |
|---------|----------------|
| Framework | Next.js 14 with App Router |
| Styling | Tailwind CSS with custom dark theme |
| Charts | Recharts (Pie, Line, Bar charts) |
| State | React Context (Auth, Toast notifications) |
| Auth | Supabase Auth with JWT handling |
| Components | Custom UI component library |

**Key Pages:**
- `/` - Security Dashboard (stats, charts, alerts)
- `/repositories` - Repository management
- `/scans` - Scan history and details
- `/secrets` - Detected secrets list
- `/reports` - PDF report generation
- `/settings` - User preferences

### 2. Backend (FastAPI REST API)

**Location:** `backend/`

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                 # Application entry point
â”‚   â”œâ”€â”€ api/v1/
â”‚   â”‚   â”œâ”€â”€ router.py          # API router aggregation
â”‚   â”‚   â””â”€â”€ endpoints/
â”‚   â”‚       â”œâ”€â”€ auth.py        # Authentication (login/register/refresh)
â”‚   â”‚       â”œâ”€â”€ users.py       # User management
â”‚   â”‚       â”œâ”€â”€ repositories.py # Repository CRUD
â”‚   â”‚       â”œâ”€â”€ scans.py       # Scan execution and status
â”‚   â”‚       â”œâ”€â”€ secrets.py     # Secret findings
â”‚   â”‚       â”œâ”€â”€ alerts.py      # Alert management
â”‚   â”‚       â”œâ”€â”€ reports.py     # PDF generation
â”‚   â”‚       â”œâ”€â”€ dashboard.py   # Statistics
â”‚   â”‚       â””â”€â”€ cloud.py       # S3 integration
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config.py          # Settings (Pydantic)
â”‚   â”‚   â”œâ”€â”€ database.py        # AsyncPG connection
â”‚   â”‚   â””â”€â”€ security.py        # JWT, password hashing
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ rate_limiter.py    # Request rate limiting
â”‚   â”œâ”€â”€ models/                 # SQLAlchemy ORM models
â”‚   â””â”€â”€ scanner/
â”‚       â”œâ”€â”€ engine.py          # Main scanning logic
â”‚       â”œâ”€â”€ patterns.py        # 100+ regex patterns
â”‚       â”œâ”€â”€ entropy.py         # Shannon entropy analysis
â”‚       â”œâ”€â”€ s3_scanner.py      # AWS S3 bucket scanning
â”‚       â””â”€â”€ env_analyzer.py    # .env file analysis
```

### 3. Scanner Engine

**Location:** `backend/app/scanner/`

The scanner engine uses a multi-layered detection approach:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SCANNER ENGINE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    FILE TRAVERSAL                           â”‚  â”‚
â”‚  â”‚  â€¢ Exclude: node_modules, .git, __pycache__, binary files  â”‚  â”‚
â”‚  â”‚  â€¢ Max file size: 10MB                                      â”‚  â”‚
â”‚  â”‚  â€¢ Parallel processing with ThreadPoolExecutor              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   DETECTION LAYERS                         â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚   REGEX PATTERNS   â”‚  â”‚   ENTROPY ANALYSIS â”‚          â”‚   â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                    â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ AWS Keys        â”‚  â”‚  â€¢ Shannon Entropy â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ API Keys        â”‚  â”‚  â€¢ Threshold: 4.5  â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Private Keys    â”‚  â”‚  â€¢ Base64 strings  â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ JWT Tokens      â”‚  â”‚  â€¢ Hex strings     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Passwords       â”‚  â”‚                    â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ DB URLs         â”‚  â”‚                    â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚  KEYWORD SCANNING  â”‚  â”‚   ENV ANALYSIS     â”‚          â”‚   â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                    â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ password=       â”‚  â”‚  â€¢ .env files      â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ secret=         â”‚  â”‚  â€¢ docker-compose  â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ api_key=        â”‚  â”‚  â€¢ config files    â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    RISK SCORING                             â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Score Calculation:                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Base Score (Pattern Severity)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  + Entropy Bonus (if high entropy)                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Test File Penalty (if in test directory)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  + Context Bonus (assignment, environment)            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  = Final Risk Score â†’ Category                        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  Categories:                                                â”‚  â”‚
â”‚  â”‚  â€¢ Critical (80-100): AWS keys, private keys, production   â”‚  â”‚
â”‚  â”‚  â€¢ High (60-79): API keys, database URLs, tokens           â”‚  â”‚
â”‚  â”‚  â€¢ Medium (40-59): Generic secrets, config values          â”‚  â”‚
â”‚  â”‚  â€¢ Low (20-39): Weak indicators, possible false positive   â”‚  â”‚
â”‚  â”‚  â€¢ Info (0-19): Informational, likely not a secret         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. CLI Tool

**Location:** `cli/`

```bash
# Installation
pip install VaultSentry

# Commands
VaultSentry scan ./project           # Scan directory
VaultSentry scan . --severity high   # Only high+ severity
VaultSentry scan . -f json -o out.json  # JSON output
VaultSentry scan . -f sarif          # SARIF for GitHub Security
VaultSentry config set --key api_key --value xxx  # Configure
```

**CI/CD Integration:**
```yaml
# GitHub Actions
- name: Vault Sentry Scan
  run: |
    pip install VaultSentry
    VaultSentry scan . --exit-code --severity high
```

---

## Database Schema

### Entity Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      USERS      â”‚       â”‚  REPOSITORIES   â”‚       â”‚     SCANS       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (UUID) PK    â”‚â”€â”€â”€â”   â”‚ id (SERIAL) PK  â”‚â”€â”€â”€â”   â”‚ id (SERIAL) PK  â”‚
â”‚ email           â”‚   â”‚   â”‚ user_id FK      â”‚â—€â”€â”€â”¤   â”‚ scan_id (UUID)  â”‚
â”‚ full_name       â”‚   â”‚   â”‚ name            â”‚   â”‚   â”‚ repository_id FKâ”‚â—€â”€â”
â”‚ role (enum)     â”‚   â”‚   â”‚ url             â”‚   â”‚   â”‚ user_id FK      â”‚â—€â”€â”¤
â”‚ avatar_url      â”‚   â”‚   â”‚ provider        â”‚   â”‚   â”‚ status (enum)   â”‚  â”‚
â”‚ company         â”‚   â”‚   â”‚ branch          â”‚   â”‚   â”‚ branch          â”‚  â”‚
â”‚ timezone        â”‚   â”‚   â”‚ status          â”‚   â”‚   â”‚ files_scanned   â”‚  â”‚
â”‚ preferences     â”‚   â”‚   â”‚ secrets_count   â”‚   â”‚   â”‚ secrets_found   â”‚  â”‚
â”‚ created_at      â”‚   â”‚   â”‚ last_scan_at    â”‚   â”‚   â”‚ duration        â”‚  â”‚
â”‚ updated_at      â”‚   â”‚   â”‚ created_at      â”‚   â”‚   â”‚ started_at      â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚ completed_at    â”‚  â”‚
                      â”‚                         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                      â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                        â”‚
                      â”‚   â”‚    SECRETS      â”‚   â”‚                        â”‚
                      â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚                        â”‚
                      â”‚   â”‚ id (SERIAL) PK  â”‚   â”‚                        â”‚
                      â”‚   â”‚ scan_id FK      â”‚â—€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                      â”‚   â”‚ repository_id FKâ”‚â—€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”œâ”€â”€â”€â”‚ user_id FK      â”‚   â”‚
                      â”‚   â”‚ type            â”‚   â”‚
                      â”‚   â”‚ risk_level      â”‚   â”‚
                      â”‚   â”‚ file_path       â”‚   â”‚
                      â”‚   â”‚ line_number     â”‚   â”‚
                      â”‚   â”‚ masked_value    â”‚   â”‚
                      â”‚   â”‚ entropy_score   â”‚   â”‚
                      â”‚   â”‚ status (enum)   â”‚   â”‚
                      â”‚   â”‚ resolved_at     â”‚   â”‚
                      â”‚   â”‚ created_at      â”‚   â”‚
                      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                      â”‚                         â”‚
                      â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                      â”‚   â”‚     ALERTS      â”‚   â”‚
                      â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
                      â””â”€â”€â”€â”‚ user_id FK      â”‚   â”‚
                          â”‚ secret_id FK    â”‚â”€â”€â”€â”˜
                          â”‚ scan_id FK      â”‚
                          â”‚ repository_id FKâ”‚
                          â”‚ type (enum)     â”‚
                          â”‚ title           â”‚
                          â”‚ message         â”‚
                          â”‚ severity        â”‚
                          â”‚ is_read         â”‚
                          â”‚ created_at      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    API_KEYS     â”‚       â”‚  INTEGRATIONS   â”‚       â”‚  SCAN_PATTERNS  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (SERIAL) PK  â”‚       â”‚ id (SERIAL) PK  â”‚       â”‚ id (SERIAL) PK  â”‚
â”‚ user_id FK      â”‚       â”‚ user_id FK      â”‚       â”‚ user_id FK      â”‚
â”‚ name            â”‚       â”‚ provider        â”‚       â”‚ name            â”‚
â”‚ key_hash        â”‚       â”‚ access_token    â”‚       â”‚ pattern (regex) â”‚
â”‚ key_prefix      â”‚       â”‚ refresh_token   â”‚       â”‚ risk_level      â”‚
â”‚ permissions[]   â”‚       â”‚ webhook_url     â”‚       â”‚ is_global       â”‚
â”‚ expires_at      â”‚       â”‚ settings        â”‚       â”‚ is_enabled      â”‚
â”‚ last_used_at    â”‚       â”‚ is_active       â”‚       â”‚ created_at      â”‚
â”‚ is_active       â”‚       â”‚ connected_at    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ created_at      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Enums

| Enum | Values |
|------|--------|
| `user_role` | admin, developer, viewer |
| `provider_type` | github, gitlab, bitbucket, azure |
| `scan_status` | pending, running, completed, failed, cancelled |
| `risk_level` | critical, high, medium, low, info |
| `secret_status` | active, resolved, ignored, false_positive |
| `alert_type` | critical_secret, high_secret, scan_failed, scan_completed |
| `trigger_type` | manual, webhook, scheduled, api |

---

## Security Architecture

### Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚        â”‚  Frontend   â”‚        â”‚  Backend â”‚        â”‚ Supabase â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                    â”‚                    â”‚                   â”‚
     â”‚ 1. Login Request   â”‚                    â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                    â”‚                   â”‚
     â”‚                    â”‚ 2. Auth Request    â”‚                   â”‚
     â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
     â”‚                    â”‚                    â”‚ 3. Validate       â”‚
     â”‚                    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                    â”‚                    â”‚â—€â”€â”€â”€ User Data â”€â”€â”€â”€â”‚
     â”‚                    â”‚                    â”‚                   â”‚
     â”‚                    â”‚                    â”‚ 4. Generate JWT   â”‚
     â”‚                    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”            â”‚
     â”‚                    â”‚                    â”‚â—€â”€â”€â”€â”€â”€â”˜            â”‚
     â”‚                    â”‚â—€â”€â”€â”€ Tokens â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                   â”‚                   â”‚
     â”‚                    â”‚                    â”‚                   â”‚
     â”‚ 5. API Request     â”‚                    â”‚                   â”‚
     â”‚   + Bearer Token   â”‚                    â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                    â”‚                   â”‚
     â”‚                    â”‚ 6. Forward Request â”‚                   â”‚
     â”‚                    â”‚   + Authorization  â”‚                   â”‚
     â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚
     â”‚                    â”‚                    â”‚ 7. Verify JWT     â”‚
     â”‚                    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”            â”‚
     â”‚                    â”‚                    â”‚â—€â”€â”€â”€â”€â”€â”˜            â”‚
     â”‚                    â”‚                    â”‚                   â”‚
     â”‚                    â”‚                    â”‚ 8. Check RBAC     â”‚
     â”‚                    â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”            â”‚
     â”‚                    â”‚                    â”‚â—€â”€â”€â”€â”€â”€â”˜            â”‚
     â”‚                    â”‚â—€â”€â”€â”€ Response â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                   â”‚
```

### Security Measures

| Layer | Implementation |
|-------|----------------|
| **Transport** | HTTPS/TLS 1.3 via NGINX |
| **Authentication** | JWT tokens (access + refresh) |
| **Authorization** | Role-based access control (RBAC) |
| **Password** | bcrypt hashing with salt |
| **Rate Limiting** | Token bucket algorithm (100 req/min) |
| **Input Validation** | Pydantic schemas with strict types |
| **SQL Injection** | SQLAlchemy ORM with parameterized queries |
| **XSS Prevention** | React's automatic escaping |
| **CORS** | Whitelist allowed origins |
| **Secrets Storage** | Masked in DB, never logged |

---

## Scalability Considerations

### Horizontal Scaling Architecture

```
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚    Load Balancer    â”‚
                           â”‚   (AWS ALB/Nginx)   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                       â”‚                       â”‚
              â–¼                       â–¼                       â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   API Server    â”‚     â”‚   API Server    â”‚     â”‚   API Server    â”‚
     â”‚   Instance 1    â”‚     â”‚   Instance 2    â”‚     â”‚   Instance N    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                       â”‚                       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                       â”‚                       â”‚
              â–¼                       â–¼                       â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  PostgreSQL     â”‚     â”‚  Redis Cluster  â”‚     â”‚ Celery Workers  â”‚
     â”‚  Primary/Replicaâ”‚     â”‚  (3+ nodes)     â”‚     â”‚ (Auto-scaling)  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Performance Optimizations

| Area | Strategy |
|------|----------|
| **Database** | Connection pooling, read replicas, indexed queries |
| **Caching** | Redis for sessions, rate limits, frequent queries |
| **File Processing** | Async I/O, ThreadPoolExecutor for parallelism |
| **Background Jobs** | Celery workers with auto-scaling |
| **Static Assets** | CDN (CloudFront/CloudFlare) |
| **Container Orchestration** | Kubernetes with HPA |

---

## Technology Stack

### Backend

| Technology | Version | Purpose |
|------------|---------|---------|
| Python | 3.11+ | Runtime |
| FastAPI | 0.109+ | Web Framework |
| SQLAlchemy | 2.0+ | ORM |
| Pydantic | 2.0+ | Validation |
| asyncpg | Latest | Async PostgreSQL |
| Redis-py | Latest | Cache/Queue |
| Celery | 5.3+ | Task Queue |
| python-jose | Latest | JWT |
| passlib | Latest | Password Hashing |
| ReportLab | Latest | PDF Generation |
| boto3 | Latest | AWS SDK |

### Frontend

| Technology | Version | Purpose |
|------------|---------|---------|
| Next.js | 14+ | React Framework |
| TypeScript | 5.0+ | Type Safety |
| Tailwind CSS | 3.4+ | Styling |
| Recharts | 2.0+ | Charts |
| Lucide React | Latest | Icons |
| Supabase JS | 2.0+ | Auth Client |

### Infrastructure

| Technology | Purpose |
|------------|---------|
| PostgreSQL 15+ | Primary Database |
| Redis 7+ | Cache & Queue |
| NGINX | Reverse Proxy |
| Docker | Containerization |
| Docker Compose | Local Development |
| GitHub Actions | CI/CD |

---

## Deployment Options

### 1. Docker Compose (Development/Small Scale)

```bash
docker-compose up -d
```

### 2. Kubernetes (Production)

```yaml
# Helm chart available at helm/secret-sentry
helm install secret-sentry ./helm/secret-sentry \
  --set replicas.api=3 \
  --set replicas.worker=5 \
  --set database.external=true
```

### 3. AWS ECS (Managed Containers)

Terraform templates available in `terraform/` directory.

---

## Monitoring & Observability

| Component | Tool |
|-----------|------|
| Metrics | Prometheus + Grafana |
| Logging | Loguru â†’ CloudWatch/ELK |
| Tracing | OpenTelemetry (optional) |
| Error Tracking | Sentry |
| Uptime | Health check endpoints |

---

## Future Roadmap

1. **Real-time Scanning** - WebSocket updates for live progress
2. **Machine Learning** - ML-based false positive reduction
3. **IDE Extensions** - VS Code, JetBrains plugins
4. **Git Pre-commit Hooks** - Client-side scanning
5. **Secret Rotation** - Automated credential rotation suggestions
6. **SOC2 Compliance** - Audit trail enhancements
7. **Multi-tenant** - Enterprise team workspaces

---

*Last Updated: February 2026*
*Version: 1.0.0*
